{% extends "plantilla.html" %}

{% block banner %}{% endblock %}
{% block contenido %}
{% load static %}

<!-- DataTables CSS -->
<link rel="stylesheet" href="//cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />

<div class="container mt-5">
    <h2 class="mb-4 text-center">Listado de Personas</h2>
    <a href="{% url 'nueva_persona' %}" class="btn btn-success mb-3">+ Nueva Persona</a>
    <table class="table table-bordered table-striped table-hover text-center tabla-frente" id="tabla-personas">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Cédula</th>
                <th>Nombres</th>
                <th>Apellidos</th>
                <th>Teléfono</th>
                <th>Correo</th>
                <th>Dirección</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for persona in personas %}
            <tr>
                <td>{{ persona.id_per }}</td>
                <td>{{ persona.cedula_per }}</td>
                <td>{{ persona.nombres_per }}</td>
                <td>{{ persona.apellidos_per }}</td>
                <td>{{ persona.telefono_per }}</td>
                <td>{{ persona.correo_per }}</td>
                <td>{{ persona.direccion_per }}</td>
                <td>
                    <a href="{% url 'editar_persona' persona.id_per %}" class="btn btn-outline-success">Editar</a>
                    <a href="javascript:void(0)" onclick="eliminarPersona('{% url 'eliminar_persona' persona.id_per %}');" class="btn btn-outline-success">Eliminar</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8">No hay personas registradas.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- DataTables JS -->
<script src="//cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

<script>
  $(document).ready(function() {
    $('#tabla-personas').DataTable();
  });

  function eliminarPersona(url){
      iziToast.question({
          timeout: 15000,
          close: true,
          overlay: true,
          displayMode: 'once',
          id: 'question',
          zindex: 999,
          title: 'CONFIRMACIÓN',
          message: '¿Está seguro de eliminar esta persona?',
          position: 'center',
          buttons: [
              ['<button><b>SI</b></button>', function (instance, toast) {
                  instance.hide({ transitionOut: 'fadeOut' }, toast, 'button');
                  window.location.href = url;
              }, true],
              ['<button>NO</button>', function (instance, toast) {
                  instance.hide({ transitionOut: 'fadeOut' }, toast, 'button');
              }],
          ]
      });
  }
</script>

<style>
  .tabla-frente {
      position: relative;
      z-index: 1;
  }
</style>

{% endblock %}
